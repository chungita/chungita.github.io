<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="超聲波輔助溶栓導管專案 - 結合超音波聲鉗技術與藥物溶栓的創新導管系統，提升血栓溶解效率並降低對周圍組織的損傷。Ultrasound-assisted Thrombolytic Catheter project.">
    <title data-key="project1_title"></title>
    <link rel="stylesheet" href="project-style.css?v=2.0.1">
    <script src="project-image-loader.js" async></script>
 </head>
<body>
    <header>
        <nav>
            <a href="../index.html" data-key="back_home"></a>
            <button id="lang-toggle" data-key="lang_toggle"></button>
        </nav>
    </header>
    <main>
        <article>
            <h1 data-key="project1_title"></h1>
            
            <div class="image-row">
                <img src="../files/projects/project_1/ultrasound_assisted_thrombosis_catheter.png" alt="Ultrasound-assisted Thrombolytic Catheter" loading="lazy">
            </div>

            <section>
                <h2 data-key="project1_overview_title"></h2>
                <p data-key="project1_overview_desc"></p>
            </section>

            <section>
                <h2 data-key="project1_prototype_title"></h2>
                <p data-key="project1_prototype_desc"></p>
                <div class="media-row">
                    <video id="catheter-video" controls autoplay muted playsinline poster="../files/projects/project_1/ultrasound_assisted_thrombosis_catheter.png" data-lazy-enabled="true">
                        <source src="../files/projects/project_1/catheter.mp4" type="video/mp4">
                    </video>
                    <img id="fpc-image" class="fpc-image" src="../files/projects/project_1/catheter_FPC.jpg" alt="Catheter FPC Design" loading="lazy">
                </div>
            </section>

            <section>
                <h2 data-key="project1_types_title"></h2>
                <p data-key="project1_types_desc"></p>
                
                <div class="catheter-types-container">
                    <div class="catheter-before-tubing">
                        <div class="catheter-type-item">
                            <img src="../files/projects/project_1/catheter_no_tube.jpg" alt="Before Tubing Catheter" loading="lazy">
                            <p class="image-caption" data-key="project1_notube_caption"></p>
                        </div>
                    </div>
                    
                    <div class="catheter-arrow">
                        <span>↓</span>
                    </div>
                    
                    <div class="catheter-types-grid">
                        <div class="catheter-type-item">
                            <img src="../files/projects/project_1/catheter_dynaflex_tube.jpg" alt="Dynaflex Tube Catheter" loading="lazy">
                            <p class="image-caption" data-key="project1_dynaflex_caption"></p>
                        </div>
                        <div class="catheter-type-item">
                            <img src="../files/projects/project_1/catheter_zuss_tube.jpg" alt="Zuss Tube Catheter" loading="lazy">
                            <p class="image-caption" data-key="project1_zuss_caption"></p>
                        </div>
                    </div>
                </div>
            </section>

            <section>
                <h2 data-key="project1_welding_title"></h2>
                <p data-key="project1_welding_desc"></p>
                
                <div class="welding-grid">
                    <div class="welding-item">
                        <img src="../files/projects/project_1/weilding_process_1.jpg" alt="Welding Process Step 1" loading="lazy">
                        <p class="image-caption" data-key="project1_welding1_caption"></p>
                    </div>
                    <div class="welding-item">
                        <img src="../files/projects/project_1/weilding_process_2.jpg" alt="Welding Process Step 2" loading="lazy">
                        <p class="image-caption" data-key="project1_welding2_caption"></p>
                    </div>
                    <div class="welding-item">
                        <img src="../files/projects/project_1/weilding_process_finish_front.jpg" alt="Welding Finished - Front View" loading="lazy">
                        <p class="image-caption" data-key="project1_welding_front_caption"></p>
                    </div>
                    <div class="welding-item">
                        <img src="../files/projects/project_1/weilding_process_finish_side.jpg" alt="Welding Finished - Side View" loading="lazy">
                        <p class="image-caption" data-key="project1_welding_side_caption"></p>
                    </div>
                    <div class="welding-item">
                        <img src="../files/projects/project_1/weilding_finish_ground_wire.jpg" alt="Ground Wire Welding - Front" loading="lazy">
                        <p class="image-caption" data-key="project1_ground_front_caption"></p>
                    </div>
                    <div class="welding-item">
                        <img src="../files/projects/project_1/weilding_finish_ground_wire_side.jpg" alt="Ground Wire Welding - Side" loading="lazy">
                        <p class="image-caption" data-key="project1_ground_side_caption"></p>
                    </div>
                </div>
            </section>

            <section>
                <h2 data-key="project1_tech_title"></h2>
                <div data-key="project1_tech_desc"></div>
            </section>

            <section>
                <h2 data-key="project1_applications_title"></h2>
                <div data-key="project1_applications_desc"></div>
            </section>

            <section>
                <h2 data-key="project1_future_title"></h2>
                <div data-key="project1_future_desc"></div>
            </section>
        </article>
    </main>
    <footer>
        <img id="item-image" class="item-image" src="" alt="Item" loading="lazy">
        <img src="../files/images/game/crafting_table.png" alt="Crafting Table" class="footer-crafting-table" loading="lazy">
        <p data-key="footer_text"></p>
    </footer>
    <script src="project-lang.js?v=2.0.1" defer></script>
    <script defer>
        document.addEventListener('DOMContentLoaded', () => {
            // 桌面自动播放，移动设备懒加载
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            const videos = document.querySelectorAll('video[data-lazy-enabled="true"]');
            
            if (isMobile) {
                // 移动设备：移除自动播放
                videos.forEach(video => {
                    video.removeAttribute('autoplay');
                    video.preload = 'none';
                });
                
                // 使用 Intersection Observer 实现懒加载
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const video = entry.target;
                            const sources = video.querySelectorAll('source');
                            sources.forEach(source => {
                                if (!source.src) {
                                    source.src = source.dataset.src || source.parentElement.dataset.src;
                                }
                            });
                            video.load();
                            observer.unobserve(video);
                        }
                    });
                }, { rootMargin: '50px' });
                
                videos.forEach(video => observer.observe(video));
            }
            // 桌面：自动播放已由 HTML 属性处理
        });
    </script>
    <img id="random-game-image" class="random-game-image" src="" alt="Random Game Character" loading="lazy">
    <img id="target-image" class="target-image" src="" alt="Target">
    <script>
        (function(){
            const vid = document.getElementById('catheter-video');
            const img = document.getElementById('fpc-image');
            if(!vid || !img) return;

            function setImgHeight(){
                const rect = vid.getBoundingClientRect();
                const h = Math.round(rect.height);
                if(h <= 0) return;

                img.style.boxSizing = 'border-box';
                img.style.display = 'block';

                const natural = img.naturalHeight || Infinity;
                const target = Math.min(h, natural);

                img.style.maxHeight = target + 'px';
                img.style.height = 'auto';
                img.style.width = 'auto';
                img.style.objectFit = 'contain';
            }

            let resizeTimer = null;
            function debouncedUpdate(){
                if(resizeTimer) clearTimeout(resizeTimer);
                resizeTimer = setTimeout(() => {
                    setImgHeight();
                    resizeTimer = null;
                }, 100);
            }

            if(window.ResizeObserver){
                const ro = new ResizeObserver(debouncedUpdate);
                ro.observe(vid);
                const parent = vid.parentElement;
                if(parent) ro.observe(parent);
            } else {
                vid.addEventListener('loadedmetadata', setImgHeight);
                vid.addEventListener('loadeddata', setImgHeight);
                vid.addEventListener('play', setImgHeight);
                window.addEventListener('resize', () => setTimeout(setImgHeight, 120));
                window.addEventListener('load', () => setTimeout(setImgHeight, 200));
            }

            setTimeout(setImgHeight, 250);
        })();
    </script>
</body>
</html>
